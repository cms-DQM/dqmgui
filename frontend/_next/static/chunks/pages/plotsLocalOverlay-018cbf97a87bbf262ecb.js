(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[461],{37132:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Qe}});var n=r(85893),a=r(67294),o=r(9008),i=r(20154),l=r(11163),s=r(60331),c=r(67034),u=r(87276),p=r(87757),d=r.n(p),f=r(15861),h=r(7826),m=r.n(h),y=r(253),v=r(69046),j=r(50298),b=r(4942),g=r(9669),O=r.n(g),x=r(4299);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=(0,a.useState)(null),i=o[0],l=o[1],s=(0,a.useState)(!1),c=s[0],u=s[1],p=(0,a.useRef)(null),h=(0,a.useState)([]),m=h[0],y=h[1];return(0,a.useEffect)((function(){var e;p&&(null===(e=p.current)||void 0===e||e.cancel())}),[]),(0,a.useEffect)((function(){var r=O().CancelToken;p.current=r.source();return n&&function(){var r=(0,f.Z)(d().mark((function r(){var n,a,o,i,s,c,f,h;return d().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u(!0);case 2:return r.prev=2,setTimeout(null===(n=p.current)||void 0===n?void 0:n.cancel,18e4),o=x.Jg.split("/"),i=o.indexOf("plotsLocalOverlay"),o.splice(i,1),s=o.join("/"),r.next=10,O().request(w({url:"".concat(s).concat("").concat(e),method:t.method||"get",cancelToken:null===(a=p.current)||void 0===a?void 0:a.token},t));case 10:c=r.sent,f=c.data,l(f),u(!1),r.next=22;break;case 16:r.prev=16,r.t0=r.catch(2),u(!1),y([r.t0.toString()]),O().isCancel(r.t0)&&(u(!1),y(["Request Timeout"])),null===(h=p.current)||void 0===h||h.cancel();case 22:case"end":return r.stop()}}),r,null,[[2,16]])})));return function(){return r.apply(this,arguments)}}()(),function(){return y([])}}),r),{data:i,isLoading:c,errors:m,cancelSource:p}},S=function(){var e=(0,f.Z)(d().mark((function e(t,r,n){var a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementById(r)){e.next=5;break}return a=function(){JSROOT.cleanup&&JSROOT.cleanup(r)},e.next=4,a;case 4:JSROOT.draw("".concat(t).concat(r),JSROOT.parse(JSON.stringify(n)),"".concat(t));case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Z=function(e){var t,r=e.params_for_api,o=e.id,i={};r.height=y.J7[r.size].size.h,r.width=y.J7[r.size].size.w;var l=[];r.overlaidSeparately&&(null===(t=r.overlaidSeparately)||void 0===t||t.plots.forEach(function(){var e=(0,f.Z)(d().mark((function e(t){var n,a,o,i,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.run_number,a=r.dataset_name,o=t.folders_path,i=t.plot_name,s={run_number:n,dataset_name:a,folders_path:o,plot_name:i},l.push(s);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var s={run_number:r.run_number,dataset_name:r.dataset_name,folders_path:r.folders_path,plot_name:r.plot_name};l.push(s);var c,p=l.map((function(e){return P((0,v.XB)(e),{},[e.plot_name,x.Jg]).data})),h=r.normalize?"hist":"nostack";m()(p).length===r.overlaidSeparately.plots.length+1&&(i=(c=JSROOT).CreateTHStack.apply(c,(0,u.Z)(m()(p))));return a.useEffect((function(){S(h,o,i)}),[o,r.jsroot,p,r.dataset_name,r.run_number,r.normalize]),(0,n.jsxs)("div",{children:[(0,n.jsx)(j.Ne,{id:"".concat(h).concat(o),width:r.width,height:r.height}),(0,n.jsx)(j.Ne,{id:"".concat(h).concat(o),width:r.width,height:r.height})]})},z=r(31097),E=r(30454),k=function(){var e=(0,f.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementById(t)){e.next=9;break}return e.prev=1,e.next=4,JSROOT.cleanup(t);case 4:JSROOT.draw(t,JSROOT.parse(JSON.stringify(r)),"hist"),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}(),D=function(e){var t,r=e.params_for_api,o=e.id,l=a.useRef(null),s=P((0,v.XB)(r),{},[r.plot_name,x.Jg]).data,c=a.useState(0),u=(0,i.Z)(c,2),p=u[0],d=u[1],f=a.useState(!1),h=(0,i.Z)(f,2),m=h[0],y=h[1],b=a.useRef(null);a.useRef(null);return a.useEffect((function(){l.current&&k("".concat(o),s)}),[s,o,l.current]),a.useEffect((function(){d(p+1),b.current&&p<3&&y(b.current.clientHeight>24)}),[b.current&&b.current.clientHeight]),(0,n.jsx)(z.Z,{title:m?r.plot_name:"",children:(0,n.jsxs)("div",{style:{width:r.width+8,height:r.height+24,margin:8,display:"flex",flexDirection:"column",background:"white"},children:[(0,n.jsx)("div",{ref:b,style:{background:E.r.colors.primary.light,paddingBottom:8,display:"flex"},children:m?(null===(t=r.plot_name)||void 0===t?void 0:t.substring(0,30))+"...":r.plot_name}),(0,n.jsxs)("div",{children:["      ",(0,n.jsx)(j.Ne,{ref:l,id:o,width:r.width,height:r.height})]})]})})},R=function(e){var t=e.params_for_api,r=!!t.overlaidSeparately&&t.overlaidSeparately.plots.length>0,a=(0,c.YO)();return r?(0,n.jsx)(Z,{id:a,params_for_api:t}):(0,n.jsx)(D,{id:a,params_for_api:t})},C=r(48330),J=r(46245),L=r(87562),T=function(e){var t,r=e.parameters,o=!!r.overlaidSeparately&&r.overlaidSeparately.plots.length>0?(0,J.Tc)(r):(0,L.Rc)(r),l=a.useState(!1),s=(0,i.Z)(l,2),c=(s[0],s[1]),u=a.useState(0),p=(0,i.Z)(u,2),d=p[0],f=p[1],h=a.useState(!1),m=(0,i.Z)(h,2),y=m[0],v=m[1],j=a.useRef(null),b=a.useRef(null);a.useEffect((function(){f(d+1),j.current&&d<3&&v(j.current.clientHeight>24)}),[j.current&&j.current.clientHeight]);var g=x.Jg.split("/"),O=g.indexOf("plotsLocalOverlay");g.splice(O,1);var _=g.join("/");return(0,n.jsx)(z.Z,{title:y?r.plot_name:"",children:(0,n.jsxs)("div",{style:{width:r.width+8,height:r.height+24,margin:8,display:"flex",flexDirection:"column",background:"white"},children:[(0,n.jsx)("div",{ref:j,style:{background:E.r.colors.primary.light,paddingBottom:8,display:"flex"},children:y?(null===(t=r.plot_name)||void 0===t?void 0:t.substring(0,30))+"...":r.plot_name}),(0,n.jsx)("div",{children:(0,n.jsx)(C.o,{ref:b,onLoad:function(){},retryTimes:3,setImageError:c,style:{display:"display",width:r.width,height:r.height},src:"".concat(_).concat("").concat(o),width:"auto",height:"auto"},"".concat(_).concat(o))})]})})};function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var N=function(e){var t=e.parameters,r=e.plot,o=a.useState(!1),l=(0,i.Z)(o,2),s=(l[0],l[1]),c=a.useState(0),u=(0,i.Z)(c,2),p=u[0],d=u[1],f=a.useState(!1),h=(0,i.Z)(f,2),m=h[0],y=h[1],v=a.useRef(null),j=a.useRef(null),b=t.run_number,g=t.dataset_name,O=t.height,_=t.width,w=t.stats,P=t.error,S=r.folders_path,Z=r.plot_name,k={run_number:b,dataset_name:g,folders_path:S,plot_name:Z,height:O,width:_,error:P,stats:w},D=(0,L.Rc)(k);a.useEffect((function(){d(p+1),v.current&&p<3&&y(v.current.clientHeight>24)}),[v.current&&v.current.clientHeight]);var R=x.Jg.split("/"),J=R.indexOf("plotsLocalOverlay");R.splice(J,1);var T=R.join("/");return(0,n.jsx)(z.Z,{title:m?Z:"",children:(0,n.jsxs)("div",{style:{width:t.width+8,height:t.height+24,margin:8,display:"flex",flexDirection:"column",background:"white"},children:[(0,n.jsx)("div",{ref:v,style:{background:E.r.colors.primary.light,paddingBottom:8,display:"flex"},children:m?(null===Z||void 0===Z?void 0:Z.substring(0,30))+"...":Z}),(0,n.jsx)("div",{children:(0,n.jsx)(C.o,{ref:j,onLoad:function(){},retryTimes:3,setImageError:s,style:{display:"display",width:t.width,height:t.height},src:"".concat(T).concat("").concat(D),width:"auto",height:"auto"},"".concat(T).concat(D))})]})})},H=function(e){var t=e.parameters,r=a.useState(!1),o=(0,i.Z)(r,2),l=(o[0],o[1]),s=a.useState(0),c=(0,i.Z)(s,2),u=c[0],p=c[1],d=a.useState(!1),f=(0,i.Z)(d,2),h=f[0],m=f[1],y=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t),v=y.overlaidSeparately?y.overlaidSeparately.plots:[],j=y.run_number,g=y.dataset_name,O=y.folders_path,_=y.plot_name,w={run_number:j,dataset_name:g,folders_path:O,plot_name:_,height:y.height,width:y.width,stats:y.stats,error:y.error},P=(0,L.Rc)(w),S="".concat(x.Jg).concat(P),Z=a.useRef(null);return a.useEffect((function(){p(u+1),Z.current&&u<3&&m(Z.current.clientHeight>24)}),[Z.current&&Z.current.clientHeight]),(0,n.jsx)("div",{style:{display:"flex",flexWrap:"wrap",overflow:"scroll",height:"100%"},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.Z,{title:h?_:"",children:(0,n.jsxs)("div",{style:{width:t.width+8,height:t.height+24,margin:8,display:"flex",flexDirection:"column",background:"white"},children:[(0,n.jsx)("div",{ref:Z,style:{background:E.r.colors.primary.light,paddingBottom:8,display:"flex"},children:h?(null===_||void 0===_?void 0:_.substring(0,30))+"...":_}),(0,n.jsx)("div",{children:(0,n.jsx)(C.o,{retryTimes:3,setImageError:l,style:{display:"display",width:t.width,height:t.height},src:S,width:"auto",height:"auto"},S)})]})}),v.map((function(e){return(0,n.jsx)(N,{plot:e,parameters:y})}))]})})},q=function(e){var t=e.parameters;return!!(!!t.overlaidSeparately&&t.overlaidSeparately.plots.length>0)&&"onSide"===t.overlaidSeparately.ref?(0,n.jsx)(H,{parameters:t}):(0,n.jsx)(T,{parameters:t})},A=function(e){var t=e.parameters,r=e.plotsAreaWidth;if("fill"===t.size){var a=t.width/t.height,o=Math.floor(r/a),i=r;t.height=o,t.width=i}return t.jsroot?(0,n.jsx)(R,{params_for_api:t}):(0,n.jsx)(q,{parameters:t})},B=r(15746),G=r(55019),F=r(87462),M=r(94184),W=r.n(M),V=r(50344),X=r(65632);function Q(e){var t=e.className,r=e.direction,n=e.index,o=e.marginDirection,i=e.children,l=e.split,s=e.wrap,c=a.useContext(Y),u=c.horizontalSize,p=c.verticalSize,d=c.latestIndex,f={};return"vertical"===r?n<d&&(f={marginBottom:u/(l?2:1)}):f=(0,F.Z)((0,F.Z)({},n<d&&(0,b.Z)({},o,u/(l?2:1))),s&&{paddingBottom:p}),null===i||void 0===i?null:a.createElement(a.Fragment,null,a.createElement("div",{className:t,style:f},i),n<d&&l&&a.createElement("span",{className:"".concat(t,"-split"),style:f},l))}var U=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},Y=a.createContext({latestIndex:0,horizontalSize:0,verticalSize:0}),$={small:8,middle:16,large:24};var K=function(e){var t,r=a.useContext(X.E_),n=r.getPrefixCls,o=r.space,l=r.direction,s=e.size,c=void 0===s?(null===o||void 0===o?void 0:o.size)||"small":s,u=e.align,p=e.className,d=e.children,f=e.direction,h=void 0===f?"horizontal":f,m=e.prefixCls,y=e.split,v=e.style,j=e.wrap,g=void 0!==j&&j,O=U(e,["size","align","className","children","direction","prefixCls","split","style","wrap"]),x=a.useMemo((function(){return(Array.isArray(c)?c:[c,c]).map((function(e){return function(e){return"string"===typeof e?$[e]:e||0}(e)}))}),[c]),_=(0,i.Z)(x,2),w=_[0],P=_[1],S=(0,V.Z)(d,{keepEmpty:!0});if(0===S.length)return null;var Z=void 0===u&&"horizontal"===h?"center":u,z=n("space",m),E=W()(z,"".concat(z,"-").concat(h),(t={},(0,b.Z)(t,"".concat(z,"-rtl"),"rtl"===l),(0,b.Z)(t,"".concat(z,"-align-").concat(Z),Z),t),p),k="".concat(z,"-item"),D="rtl"===l?"marginLeft":"marginRight",R=0,C=S.map((function(e,t){return null!==e&&void 0!==e&&(R=t),a.createElement(Q,{className:k,key:"".concat(k,"-").concat(t),direction:h,index:t,marginDirection:D,split:y,wrap:g},e)}));return a.createElement("div",(0,F.Z)({className:E,style:(0,F.Z)((0,F.Z)({},g&&{flexWrap:"wrap",marginBottom:-P}),v)},O),a.createElement(Y.Provider,{value:{horizontalSize:w,verticalSize:P,latestIndex:R}},C))},ee=r(71577),te=r(74130);function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var ne=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e);return r.plot_name=t,r},ae=function(e){var t=e.lastSelectedPlot,r=e.setSelectedPlots,o=e.selectedPlots,i=e.query,l=e.overlaidGlobally,s=[{title:"Run",dataIndex:"run_number"},{title:"Dataset name",dataIndex:"dataset_name"},{title:"Path",dataIndex:"folders_path"},{title:"Plot Name",dataIndex:"plot_name"},{title:"Label",render:function(e){if(e.folders_path&&e.plot_name)return(0,n.jsx)(G.Z,{id:e.folders_path+e.plot_name,defaultValue:e.label,name:e.folders_path+e.plot_name,placeholder:"label",value:e.label,onChange:function(t){var n=t.target.value,a=function(e,t,r){var n=(0,u.Z)(t),a=n.indexOf(e);return n[a].label=encodeURI(r),n}(e,o,encodeURI(n));r(a)}})}},{title:"Action",key:"action",render:function(e){var t=l.findIndex((function(t){return t.plot_name===e.plot_name&&t.folders_path===e.folders_path&&t.dataset_name===e.dataset_name&&t.run_number===e.run_number}))>-1;return(0,n.jsx)(K,{size:"small",children:(0,n.jsx)(z.Z,{title:t?"Plot was overlaid before (globally or by layout configuration) selecting the plot.":"",children:(0,n.jsx)(ee.Z,{type:"link",disabled:t,onClick:function(){r(function(e,t){var r=(0,u.Z)(t),n=r.indexOf(e);return r.splice(n,1),r}(e,o))},children:"Delete"})})})}}];return a.useEffect((function(){if(i.overlayPlots){var e=i.overlayPlots.split("&").map((function(e){var t=e.split("reflabel="),r=2===t.length?t[1]:"",n=t[0].split("/"),a=n.pop();return{folders_path:m()(n).join("/"),plot_name:a,label:r,run_number:i.run_number,dataset_name:i.dataset_name}}));r(e)}}),[]),a.useEffect((function(){if(t&&t.plot_name){var e=(0,u.Z)(o),n=(a=t,-1===(i=e).indexOf(a)&&i.push(a),i);r(n)}var a,i}),[t]),a.useEffect((function(){var e=l.filter((function(e){if(!o.includes(e))return e})).concat(o);e.length>0&&r(e)}),[i.overlaidGlobally]),o.length>0?(0,n.jsx)(te.iy,{pagination:{defaultPageSize:1,pageSizeOptions:["1","2","3","4","5"],showSizeChanger:!0},columns:s,dataSource:o.reverse()}):(0,n.jsx)(n.Fragment,{})},oe=r(94108),ie=r(18554),le=r(10925),se=r(80129),ce=r.n(se);function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var de=function(){var e=(0,f.Z)(d().mark((function e(t,r){var n,a,o,i,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=pe({},t),e.next=3,delete n.overlayPlots;case 3:return e.next=5,delete n.overlaidSeparately;case 5:return e.next=7,delete n.customizationParams;case 7:return a=pe({},t.customise),e.next=10,delete n.overlaidGlobally;case 10:o=pe(pe(pe({},n),a),{},{overlaidGlobally:r.query.overlaidGlobally}),i=ce().stringify(o,{}),s="/"!==x.A?"".concat(x.A,"?").concat(i):void 0,l.default.push({pathname:r.pathname,query:o},s);case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),fe=function(){var e=(0,f.Z)(d().mark((function e(t,r,n){var a,o,i,s,c,u,p,f;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=pe({},r),o=r.overlaidSeparately,i=o.ref,s={ref:i},e.next=6,delete a.customise;case 6:return e.next=8,delete a.overlaidSeparately;case 8:return e.next=10,delete a.customizationParams;case 10:return e.next=12,delete a.overlaidGlobally;case 12:c=pe({},r.customise),u=pe(pe(pe(pe({},a),s),c),{},{overlaidGlobally:n.query.overlaidGlobally,overlayPlots:t}),p=ce().stringify(u,{}),f=""!==x.A?"".concat(x.A,"?").concat(p):void 0,l.default.push({pathname:n.pathname,query:u},f);case 17:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),he=function(){var e=(0,f.Z)(d().mark((function e(t,r,n){var a,o,i,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=pe({},n),e.next=3,delete a.customizationParams;case 3:o=pe(pe({},r.query),{},{search:t}),i=ce().stringify(o,{}),s="/"!==x.A?"".concat(x.A,"?").concat(i):void 0,l.default.push({pathname:r.pathname,query:o},s);case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),me=function(){var e=(0,f.Z)(d().mark((function e(t,r,n){var a,o,i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=pe(pe({},t.query),r),o=ce().stringify(a,{}),i="/"!==x.A?"".concat(x.A,"?").concat(o):void 0,l.default.push({pathname:t.pathname,query:a},i);case 4:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),ye=function(e){var t=e.plotNames,r=e.setLastSelectedPlot,a=e.selectedPlots,o=e.lastSelectedPlot,i=e.dataset_name,l=e.run_number,s=t.map((function(e,t){return{key:t,plot_name:e}})),c=x.Jg.split("/"),u=c.indexOf("plotsLocalOverlay");c.splice(u,1);var p=c.join("/"),d=[{title:"Plot name",dataIndex:"plot_name",key:"plot_name",render:function(e){var t=o.folders_path,i=e,l=a.findIndex((function(e){return e.folders_path===t&&e.plot_name===i}))>-1,s=a.length>=8,c=l||s,u=s?"Cannot be selected more than 8 plots!":l?"This plot is already selected":"";return(0,n.jsx)(z.Z,{title:u,children:(0,n.jsx)(ee.Z,{disabled:c,onClick:function(){return r(ne(o,e))},children:e})})},sorter:function(e,t){return e.plot_name<t.plot_name?-1:e.plot_name>t.plot_name?1:0},sortDirections:["ascend"]},{title:"Action",dataIndex:"plot_name",key:"plot_name",render:function(e){var t={run_number:l,dataset_name:i,folders_path:o.folders_path,plot_name:encodeURIComponent(e),height:y.J7.small.size.h,width:y.J7.small.size.w},r=(0,L.Rc)(t);return(0,n.jsx)(z.Z,{title:(0,n.jsx)("img",{src:"".concat(p).concat("").concat(r)}),children:(0,n.jsx)(K,{size:"small",children:(0,n.jsx)("a",{children:"Show plot"})})})}}];return(0,n.jsx)(te.iy,{columns:d,dataSource:s})},ve=r(4838),je=r(41156);function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Oe=function(e){var t=e.me_count,r=e.children;return(0,n.jsx)(je.LH,{count:t,children:r})},xe=function(e){var t=e.setParameters,r=e.parameters,o=e.referenceHeight,s=a.useState({dataset_name:"",run_number:"",folders_path:"",plot_name:""}),c=(0,i.Z)(s,2),p=c[0],d=c[1],f=a.useState([]),h=(0,i.Z)(f,2),y=h[0],v=h[1],b=a.useState(""),g=(0,i.Z)(b,2),O=g[0],_=g[1],w=a.useState([]),S=(0,i.Z)(w,2),Z=S[0],z=S[1],E=a.useRef(null),k=a.useRef(null),D=a.useState(0),R=(0,i.Z)(D,2),C=R[0],J=R[1],L=(0,l.useRouter)(),T=L.query,I={dataset_name:T.dataset_name,run_number:T.run_number,folders_path:p.folders_path,plot_search:T.search},N=(0,ie.Lw)(I),H=P(N,{},[x.Jg,p.folders_path,r.run_number,T.search,r.plot_search,r.dataset_name,r.plot_name]);a.useEffect((function(){var e=(0,u.Z)(y),t=y.indexOf(O);if(t>=0){var r=e.splice(0,t+1);v(r);var n=r.join("/");d({folders_path:n,plot_name:""})}else{e.push(O);var a=m()(e)?m()(e):[];v(a);var o=e.join("/");0===a.length&&d({dataset_name:"",run_number:"",folders_path:"",plot_name:""}),d({dataset_name:T.dataset_name,run_number:T.run_number,folders_path:o,plot_name:""})}}),[O]),a.useEffect((function(){var e=ge({},r),n={overlaidSeparately:{plots:Z}},a=ge(ge({},e),n);t(a),Z.map((function(e){return e.label?[e.folders_path,e.plot_name,"reflabel="+e.label].join("/"):[e.folders_path,e.plot_name].join("/")})).join("&").length>0?(e.overlaidSeparately=ge(ge({},r.overlaidSeparately),{},{plots:Z}),t(e)):(e.overlaidSeparately=ge(ge({},r.overlaidSeparately),{},{plots:[]}),t(e))}),[Z.length]);var q=r.overlaidSeparately.plots.map((function(e){return e.label})).join(",");a.useEffect((function(){var e=Z.map((function(e){return e.label?[e.folders_path,e.plot_name,"reflabel="+e.label].join("/"):[e.folders_path,e.plot_name].join("/")})).join("&");e.length>0?fe(e,r,L):de(r,L)}),[r.size,q,r.overlaidSeparately.plots,r.overlaidSeparately&&r.overlaidSeparately.ref,r.jsroot,r.stats,r.normalize,r.error]),a.useEffect((function(){k.current&&E.current?J(k.current.clientHeight+E.current.clientHeight):J(0)}),[E.current&&E.current.clientHeight,k.current&&k.current.clientHeight,k.current,o]);var A=H.data,G=function(e){var t=[],r=[];return e.forEach((function(e){t.push({subdir:e.subdir,me_count:e.me_count}),r.push(e.name)})),{directories:m()(t).sort((function(e,t){return e.subdir<t.subdir?-1:e.subdir>t.subdir?1:0})),plots:m()(r)}}(A?A.data:[]),F=G.directories,M=G.plots;return(0,n.jsxs)(te.N0,{gutter:16,smaller:o.toString(),children:[(0,n.jsx)(B.Z,{style:{padding:8},ref:k,children:(0,n.jsx)(oe.b,{folder_path:p.folders_path,changeFolderPathByBreadcrumb:function(e){return(t=e,function(e,r){var n=t.folder_path.split("/"),a=m()(n)?m()(n):[];e(a),a.length>0?r(a[a.length-1]):r("")})(v,_);var t}})}),(0,n.jsx)(te.WC,{ref:E,children:(0,n.jsx)(ae,{query:T,lastSelectedPlot:p,overlaidGlobally:r.overlaidGlobally,selectedPlots:Z,setSelectedPlots:z})}),(0,n.jsxs)(te.Eo,{smaller:C.toString(),children:[!H.isLoading&&(0,n.jsx)(te.WC,{children:F.sort().map((function(e){return(0,n.jsx)(B.Z,{span:4,children:(0,n.jsx)(j.dg,{children:(0,n.jsxs)(je.Jf,{hover:"true",display:"flex",space:"1",alignitems:"center",onClick:function(){return _(e.subdir)},children:[(0,n.jsx)(Oe,{me_count:e.me_count?e.me_count:0,children:(0,n.jsx)(j.JO,{})}),(0,n.jsx)(j.nB,{children:e.subdir})]})})},e.subdir)}))}),H.isLoading&&(0,n.jsx)(te.x9,{children:(0,n.jsx)(le.$j,{})}),!H.isLoading&&M.length>0&&(0,n.jsx)(ye,{plotNames:M,setLastSelectedPlot:d,lastSelectedPlot:p,selectedPlots:Z,dataset_name:T.dataset_name,run_number:T.run_number}),0===F.length&&0===M.length&&(0,n.jsx)(te.y4,{children:(0,n.jsx)(ve.Q,{})})]})]})},_e=r(48086),we=r(12028);function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Se=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);return r.jsroot=e,r},Ze=function(e){var t=e.setReference,r=e.reference,a=e.disabled;return(0,n.jsx)(we.Z,{disabled:a,style:{width:"fit-content"},checkedChildren:"JSROOT enabled",unCheckedChildren:"JSROOT disabled",checked:r.jsroot,onChange:function(e){t(Se(e,r))}})},ze=r(37531),Ee=r(7653);function ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var De=ze.Z.Option,Re=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ke(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);return r.ref=e,r},Ce=function(e){var t=e.setReference,r=e.reference;return(0,n.jsx)(Ee.Qr,{onChange:function(e){return t(Re(e,r))},defaultValue:r.ref,children:y.jJ.map((function(e){return(0,n.jsx)(De,{value:e.value,children:e.label},e.value)}))})};function Je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Le=ze.Z.Option,Te=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);return r.size=e,r},Ie=function(e){var t=e.setReference,r=e.reference,a=Object.keys(y.J7);return(0,n.jsx)(Ee.Qr,{onChange:function(e){return t(Te(e,r))},defaultValue:r.size,children:a.map((function(e){return(0,n.jsx)(Le,{value:e,children:y.J7[e].label},e)}))})},Ne=r(90172),He=r(49549);function qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Be=function(e){var t,r=e.router,o=e.parameters,l=e.setParameters,s=r.query,c=o.size,u=s.overlayPosition?s.overlayPosition:"overlay",p=!!s.jsroot&&"true"===s.jsroot,h=a.useState(!1),v=(0,i.Z)(h,2),j=v[0],g=v[1],O=a.useState({}),x=(0,i.Z)(O,2),_=x[0],w=x[1],P=Object.keys(o.customise?o.customise:{}).length>0,S=[{label:"Normalize",value:!s.normalize||"true"===s.normalize},{label:"Stats",value:!s.stats||"true"===s.stats},{label:"Error",value:!!s.error&&"true"===s.error}],Z=a.useState((t={size:c,jsroot:p,ref:u},(0,b.Z)(t,S[0].label.toLocaleLowerCase(),S[0].value),(0,b.Z)(t,S[1].label.toLocaleLowerCase(),S[1].value),(0,b.Z)(t,S[2].label.toLocaleLowerCase(),S[2].value),t)),E=(0,i.Z)(Z,2),k=E[0],D=E[1];return a.useEffect((function(){var e=Ae({},o);e.height=y.J7[k.size].size.h,e.width=y.J7[k.size].size.w,e.size=k.size,e.overlaidSeparately&&(e.overlaidSeparately.ref=k.ref),e.jsroot=k.jsroot,e.size=k.size,e.stats=k.stats,e.normalize=k.normalize,e.error=k.error,e.customise=_;var t=Ae(Ae({},e),{},{overlaidSeparately:Ae({},e.overlaidSeparately)});l(t)}),[k.size,k.jsroot,k.ref,k[S[0].label.toLocaleLowerCase()],k[S[1].label.toLocaleLowerCase()],k[S[2].label.toLocaleLowerCase()],_,s.ref,s.normalize,s.stats,s.error,s.jsroot,s.size]),a.useEffect((function(){var e={xtype:s.xtype,xmin:s.xmin,xmax:s.xmax,ytype:s.ytype,ymin:s.ymin,ymax:s.ymax,ztype:s.ztype,zmin:s.zmin,zmax:s.zmax,drawopts:s.drawopts,withref:s.withref};w(m()(e))}),[]),a.useEffect((function(){P&&_e.ZP.info("Plot is already customised")}),[P]),(0,n.jsxs)(te.im,{direction:"column",children:[(0,n.jsx)(He.F,{plot_name:o.plot_name,open:j,customizationParams:_,onCancel:function(){return g(!1)},setCustomisationParams:function(){var e=(0,f.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(t),e.next=3,me(r,t,o);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),(0,n.jsxs)(te.im,{direction:"row",children:[(0,n.jsx)(te.rj,{space:"2",children:(0,n.jsx)(Ie,{setReference:D,reference:k})}),(0,n.jsx)(te.rj,{space:"2",children:(0,n.jsx)(Ce,{setReference:D,reference:k})}),(0,n.jsx)(te.rj,{space:"2",children:(0,n.jsx)(Ze,{disabled:!!s.overlayPlots,setReference:D,reference:k})}),(0,n.jsx)(te.rj,{space:"2",children:(0,n.jsx)(z.Z,{title:P?"This plot is customised!":"",children:(0,n.jsx)(te.Sn,{isPlotCustomized:P.toString(),onClick:function(){return g(!j)},children:"Customize"})})})]}),(0,n.jsx)(te.im,{direction:"row",children:S.map((function(e){return(0,n.jsx)(te.rj,{space:"2",children:(0,n.jsx)(Ne.J,{option:e,setReference:D,reference:k})},e.label)}))})]})},Ge=r(13722),Fe=r(97183),Me=r(50963);function We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Ve=function(e){var t=e.parameters,r=e.setParameters,o=(0,l.useRouter)(),s=o.query,c=a.useState(s.plot_search),u=(0,i.Z)(c,2),p=u[0],d=u[1];return a.useEffect((function(){he(p||void 0,o,t)}),[p]),a.useEffect((function(){var e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?We(Object(r),!0).forEach((function(t){(0,b.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):We(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);e.search=s.search,r(e)}),[s.search]),a.useMemo((function(){return(0,n.jsx)(Me.ZP,{onChange:function(e){return d(e.target.value)},children:(0,n.jsx)(je.jp,{children:(0,n.jsx)(je.tg,{defaultValue:s.search,id:"plot_search",placeholder:"Enter plot name"})})})}),[p])},Xe=function(){var e=(0,l.useRouter)(),t=e.query,r=t.run_number,o=t.dataset_name,c=t.folders_path,u=t.plot_name,p=(t.size,a.useRef(null)),d=a.useRef(null),f=a.useState(),h=(0,i.Z)(f,2),m=h[0],v=h[1],j=a.useState(0),b=(0,i.Z)(j,2),g=b[0],O=b[1],x=a.useState(0),_=(0,i.Z)(x,2),w=_[0],P=_[1];return a.useEffect((function(){p.current&&O(p.current.clientHeight)}),[p.current]),a.useEffect((function(){d.current&&P(d.current.clientWidth)}),[d.current]),a.useEffect((function(){if(Object.keys(t).length>0){var e=t.overlaidGlobally?t.overlaidGlobally.split("&"):[],n=e.map((function(t){if(e){var r=t.split("/"),n=r.pop(),a=r.pop(),o=r.shift(),i=r.splice(3).join("/");return{run_number:o,dataset_name:"/"+r.join("/"),folders_path:i,plot_name:a,label:n}}})),a=t.ref?t.ref:"overlay",i={run_number:r,dataset_name:o,folders_path:c,plot_name:u,size:t.size?t.size:"large",jsroot:!!t.jsroot&&"true"===t.jsroot,stats:!!t.stats&&"true"===t.stats,normalize:!t.normalize||"true"===t.normalize,overlaidSeparately:{plots:[],ref:a},overlaidGlobally:n,height:y.J7[t.size?t.size:"large"].size.h,width:y.J7[t.size?t.size:"large"].size.w};v(i)}}),[t.plot_name]),m?(0,n.jsxs)(Fe.Z,{children:[(0,n.jsx)(Ge.eb,{justifyContent:"space-between",children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ge.JI,{children:(0,n.jsx)(Ge.IY,{children:(0,n.jsx)(Ge.ps,{src:"../images/CMSlogo_white_red_nolabel_1024_May2014.png"})})}),(0,n.jsxs)(te.oS,{children:[(0,n.jsx)(te.nf,{children:(0,n.jsxs)(s.Z,{color:"geekblue",children:["Run :",m.run_number]})}),(0,n.jsx)(te.nf,{children:(0,n.jsxs)(s.Z,{color:"geekblue",children:["Dataset: ",m.dataset_name]})}),(0,n.jsx)(te.nf,{children:(0,n.jsxs)(s.Z,{color:"geekblue",children:[" Folders path: ",m.folders_path]})}),(0,n.jsx)(te.nf,{children:(0,n.jsxs)(s.Z,{color:"geekblue",children:["Plot name:  ",m.plot_name]})}),(0,n.jsx)(Ve,{parameters:m,setParameters:v})]})]})}),(0,n.jsx)(te.LT,{children:(0,n.jsxs)(te.im,{direction:"row",children:[(0,n.jsx)(te.MF,{ref:d,proportion:"50%",border:(!0).toString(),children:(0,n.jsx)(A,{plotsAreaWidth:w,parameters:m})}),(0,n.jsxs)(te.MF,{proportion:"50%",children:[(0,n.jsx)("div",{ref:p,children:(0,n.jsx)(Be,{parameters:m,router:e,setParameters:v})}),(0,n.jsx)(xe,{referenceHeight:g,parameters:m,setParameters:v})]})]})})]}):(0,n.jsx)(n.Fragment,{})},Qe=function(){return(0,n.jsxs)("div",{children:[(0,n.jsx)(o.default,{children:(0,n.jsx)("script",{crossOrigin:"anonymous",type:"text/javascript",src:"./jsroot-5.8.0/scripts/JSRootCore.js?2d&hist&more2d"})}),(0,n.jsx)(Xe,{})]})}},94932:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/plotsLocalOverlay",function(){return r(37132)}])}},function(e){e.O(0,[662,324,122,774,888,179],(function(){return t=94932,e(e.s=t);var t}));var t=e.O();_N_E=t}]);