(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[461],{37132:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return $e}});var n=r(67294),a=r(9008),o=r(80318),i=r(11163),l=r(60331),s=r(67034),c=r(83789),u=r(30266),p=r(809),d=r.n(p),f=r(7826),h=r.n(f),m=r(253),y=r(69046),v=r(50298),j=r(92809),b=r(9669),g=r.n(b),O=r(4299);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=(0,n.useState)(null),i=o[0],l=o[1],s=(0,n.useState)(!1),c=s[0],p=s[1],f=(0,n.useRef)(null),h=(0,n.useState)([]),m=h[0],y=h[1];return(0,n.useEffect)((function(){var e;f&&(null===(e=f.current)||void 0===e||e.cancel())}),[]),(0,n.useEffect)((function(){var r=g().CancelToken;f.current=r.source();return a&&function(){var r=(0,u.Z)(d().mark((function r(){var n,a,o,i,s,c,u,h;return d().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p(!0);case 2:return r.prev=2,setTimeout(null===(n=f.current)||void 0===n?void 0:n.cancel,18e4),o=O.Jg.split("/"),i=o.indexOf("plotsLocalOverlay"),o.splice(i,1),s=o.join("/"),r.next=10,g().request(_({url:"".concat(s).concat("").concat(e),method:t.method||"get",cancelToken:null===(a=f.current)||void 0===a?void 0:a.token},t));case 10:c=r.sent,u=c.data,l(u),p(!1),r.next=22;break;case 16:r.prev=16,r.t0=r.catch(2),p(!1),y([r.t0.toString()]),g().isCancel(r.t0)&&(p(!1),y(["Request Timeout"])),null===(h=f.current)||void 0===h||h.cancel();case 22:case"end":return r.stop()}}),r,null,[[2,16]])})));return function(){return r.apply(this,arguments)}}()(),function(){return y([])}}),r),{data:i,isLoading:c,errors:m,cancelSource:f}},P=r(85893),S=function(){var e=(0,u.Z)(d().mark((function e(t,r,n){var a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementById(r)){e.next=5;break}return a=function(){JSROOT.cleanup&&JSROOT.cleanup(r)},e.next=4,a;case 4:JSROOT.draw("".concat(t).concat(r),JSROOT.parse(JSON.stringify(n)),"".concat(t));case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Z=function(e){var t,r=e.params_for_api,a=e.id,o={};r.height=m.J7[r.size].size.h,r.width=m.J7[r.size].size.w;var i=[];r.overlaidSeparately&&(null===(t=r.overlaidSeparately)||void 0===t||t.plots.forEach(function(){var e=(0,u.Z)(d().mark((function e(t){var n,a,o,l,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.run_number,a=r.dataset_name,o=t.folders_path,l=t.plot_name,s={run_number:n,dataset_name:a,folders_path:o,plot_name:l},i.push(s);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var l={run_number:r.run_number,dataset_name:r.dataset_name,folders_path:r.folders_path,plot_name:r.plot_name};i.push(l);var s,p=i.map((function(e){return w((0,y.XB)(e),{},[e.plot_name,O.Jg]).data})),f=r.normalize?"hist":"nostack";h()(p).length===r.overlaidSeparately.plots.length+1&&(o=(s=JSROOT).CreateTHStack.apply(s,(0,c.Z)(h()(p))));return n.useEffect((function(){S(f,a,o)}),[a,r.jsroot,p,r.dataset_name,r.run_number,r.normalize]),(0,P.jsxs)("div",{children:[(0,P.jsx)(v.Ne,{id:"".concat(f).concat(a),width:r.width,height:r.height}),(0,P.jsx)(v.Ne,{id:"".concat(f).concat(a),width:r.width,height:r.height})]})},z=r(31097),E=r(30454),k=function(){var e=(0,u.Z)(d().mark((function e(t,r){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.getElementById(t)){e.next=9;break}return e.prev=1,e.next=4,JSROOT.cleanup(t);case 4:JSROOT.draw(t,JSROOT.parse(JSON.stringify(r)),"hist"),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}(),D=function(e){var t,r=e.params_for_api,a=e.id,i=n.useRef(null),l=w((0,y.XB)(r),{},[r.plot_name,O.Jg]).data,s=n.useState(0),c=(0,o.Z)(s,2),u=c[0],p=c[1],d=n.useState(!1),f=(0,o.Z)(d,2),h=f[0],m=f[1],j=n.useRef(null);n.useRef(null);return n.useEffect((function(){i.current&&k("".concat(a),l)}),[l,a,i.current]),n.useEffect((function(){p(u+1),j.current&&u<3&&m(j.current.clientHeight>24)}),[j.current&&j.current.clientHeight]),(0,P.jsx)(z.Z,{title:h?r.plot_name:"",children:(0,P.jsxs)("div",{style:{width:r.width+8,height:r.height+24,margin:8,display:"flex",flexDirection:"column",background:"white"},children:[(0,P.jsx)("div",{ref:j,style:{background:E.r.colors.primary.light,paddingBottom:8,display:"flex"},children:h?(null===(t=r.plot_name)||void 0===t?void 0:t.substring(0,30))+"...":r.plot_name}),(0,P.jsxs)("div",{children:["      ",(0,P.jsx)(v.Ne,{ref:i,id:a,width:r.width,height:r.height})]})]})})},R=function(e){var t=e.params_for_api,r=!!t.overlaidSeparately&&t.overlaidSeparately.plots.length>0,n=(0,s.YO)();return r?(0,P.jsx)(Z,{id:n,params_for_api:t}):(0,P.jsx)(D,{id:n,params_for_api:t})},C=r(48330),J=r(46245),L=r(87562),T=function(e){var t,r=e.parameters,a=!!r.overlaidSeparately&&r.overlaidSeparately.plots.length>0?(0,J.Tc)(r):(0,L.Rc)(r),i=n.useState(!1),l=(0,o.Z)(i,2),s=(l[0],l[1]),c=n.useState(0),u=(0,o.Z)(c,2),p=u[0],d=u[1],f=n.useState(!1),h=(0,o.Z)(f,2),m=h[0],y=h[1],v=n.useRef(null),j=n.useRef(null);n.useEffect((function(){d(p+1),v.current&&p<3&&y(v.current.clientHeight>24)}),[v.current&&v.current.clientHeight]);var b=O.Jg.split("/"),g=b.indexOf("plotsLocalOverlay");b.splice(g,1);var x=b.join("/");return(0,P.jsx)(z.Z,{title:m?r.plot_name:"",children:(0,P.jsxs)("div",{style:{width:r.width+8,height:r.height+24,margin:8,display:"flex",flexDirection:"column",background:"white"},children:[(0,P.jsx)("div",{ref:v,style:{background:E.r.colors.primary.light,paddingBottom:8,display:"flex"},children:m?(null===(t=r.plot_name)||void 0===t?void 0:t.substring(0,30))+"...":r.plot_name}),(0,P.jsx)("div",{children:(0,P.jsx)(C.o,{ref:j,onLoad:function(){},retryTimes:3,setImageError:s,style:{display:"display",width:r.width,height:r.height},src:"".concat(x).concat("").concat(a),width:"auto",height:"auto"},"".concat(x).concat(a))})]})})};function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var N=function(e){var t=e.parameters,r=e.plot,a=n.useState(!1),i=(0,o.Z)(a,2),l=(i[0],i[1]),s=n.useState(0),c=(0,o.Z)(s,2),u=c[0],p=c[1],d=n.useState(!1),f=(0,o.Z)(d,2),h=f[0],m=f[1],y=n.useRef(null),v=n.useRef(null),j=t.run_number,b=t.dataset_name,g=t.height,x=t.width,_=t.stats,w=t.error,S=r.folders_path,Z=r.plot_name,k={run_number:j,dataset_name:b,folders_path:S,plot_name:Z,height:g,width:x,error:w,stats:_},D=(0,L.Rc)(k);n.useEffect((function(){p(u+1),y.current&&u<3&&m(y.current.clientHeight>24)}),[y.current&&y.current.clientHeight]);var R=O.Jg.split("/"),J=R.indexOf("plotsLocalOverlay");R.splice(J,1);var T=R.join("/");return(0,P.jsx)(z.Z,{title:h?Z:"",children:(0,P.jsxs)("div",{style:{width:t.width+8,height:t.height+24,margin:8,display:"flex",flexDirection:"column",background:"white"},children:[(0,P.jsx)("div",{ref:y,style:{background:E.r.colors.primary.light,paddingBottom:8,display:"flex"},children:h?(null===Z||void 0===Z?void 0:Z.substring(0,30))+"...":Z}),(0,P.jsx)("div",{children:(0,P.jsx)(C.o,{ref:v,onLoad:function(){},retryTimes:3,setImageError:l,style:{display:"display",width:t.width,height:t.height},src:"".concat(T).concat("").concat(D),width:"auto",height:"auto"},"".concat(T).concat(D))})]})})},G=function(e){var t=e.parameters,r=n.useState(!1),a=(0,o.Z)(r,2),i=(a[0],a[1]),l=n.useState(0),s=(0,o.Z)(l,2),c=s[0],u=s[1],p=n.useState(!1),d=(0,o.Z)(p,2),f=d[0],h=d[1],m=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t),y=m.overlaidSeparately?m.overlaidSeparately.plots:[],v=m.run_number,b=m.dataset_name,g=m.folders_path,x=m.plot_name,_={run_number:v,dataset_name:b,folders_path:g,plot_name:x,height:m.height,width:m.width,stats:m.stats,error:m.error},w=(0,L.Rc)(_),S="".concat(O.Jg).concat(w),Z=n.useRef(null);return n.useEffect((function(){u(c+1),Z.current&&c<3&&h(Z.current.clientHeight>24)}),[Z.current&&Z.current.clientHeight]),(0,P.jsx)("div",{style:{display:"flex",flexWrap:"wrap",overflow:"scroll",height:"100%"},children:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(z.Z,{title:f?x:"",children:(0,P.jsxs)("div",{style:{width:t.width+8,height:t.height+24,margin:8,display:"flex",flexDirection:"column",background:"white"},children:[(0,P.jsx)("div",{ref:Z,style:{background:E.r.colors.primary.light,paddingBottom:8,display:"flex"},children:f?(null===x||void 0===x?void 0:x.substring(0,30))+"...":x}),(0,P.jsx)("div",{children:(0,P.jsx)(C.o,{retryTimes:3,setImageError:i,style:{display:"display",width:t.width,height:t.height},src:S,width:"auto",height:"auto"},S)})]})}),y.map((function(e){return(0,P.jsx)(N,{plot:e,parameters:m})}))]})})},H=function(e){var t=e.parameters;return!!(!!t.overlaidSeparately&&t.overlaidSeparately.plots.length>0)&&"onSide"===t.overlaidSeparately.ref?(0,P.jsx)(G,{parameters:t}):(0,P.jsx)(T,{parameters:t})},q=function(e){var t=e.parameters,r=e.plotsAreaWidth;if("fill"===t.size){var n=t.width/t.height,a=Math.floor(r/n),o=r;t.height=a,t.width=o}return t.jsroot?(0,P.jsx)(R,{params_for_api:t}):(0,P.jsx)(H,{parameters:t})},A=r(15746),B=r(55019),F=r(87462),M=r(4942),W=r(29439),V=r(94184),X=r.n(V),Q=r(50344),U=r(65632);function Y(e){var t=e.className,r=e.direction,a=e.index,o=e.marginDirection,i=e.children,l=e.split,s=e.wrap,c=n.useContext(ee),u=c.horizontalSize,p=c.verticalSize,d=c.latestIndex,f={};return c.supportFlexGap||("vertical"===r?a<d&&(f={marginBottom:u/(l?2:1)}):f=(0,F.Z)((0,F.Z)({},a<d&&(0,M.Z)({},o,u/(l?2:1))),s&&{paddingBottom:p})),null===i||void 0===i?null:n.createElement(n.Fragment,null,n.createElement("div",{className:t,style:f},i),a<d&&l&&n.createElement("span",{className:"".concat(t,"-split"),style:f},l))}var $=r(98082),K=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},ee=n.createContext({latestIndex:0,horizontalSize:0,verticalSize:0,supportFlexGap:!1}),te={small:8,middle:16,large:24};var re=function(e){var t,r=n.useContext(U.E_),a=r.getPrefixCls,o=r.space,i=r.direction,l=e.size,s=void 0===l?(null===o||void 0===o?void 0:o.size)||"small":l,c=e.align,u=e.className,p=e.children,d=e.direction,f=void 0===d?"horizontal":d,h=e.prefixCls,m=e.split,y=e.style,v=e.wrap,j=void 0!==v&&v,b=K(e,["size","align","className","children","direction","prefixCls","split","style","wrap"]),g=(0,$.Z)(),O=n.useMemo((function(){return(Array.isArray(s)?s:[s,s]).map((function(e){return function(e){return"string"===typeof e?te[e]:e||0}(e)}))}),[s]),x=(0,W.Z)(O,2),_=x[0],w=x[1],P=(0,Q.Z)(p,{keepEmpty:!0}),S=void 0===c&&"horizontal"===f?"center":c,Z=a("space",h),z=X()(Z,"".concat(Z,"-").concat(f),(t={},(0,M.Z)(t,"".concat(Z,"-rtl"),"rtl"===i),(0,M.Z)(t,"".concat(Z,"-align-").concat(S),S),t),u),E="".concat(Z,"-item"),k="rtl"===i?"marginLeft":"marginRight",D=0,R=P.map((function(e,t){return null!==e&&void 0!==e&&(D=t),n.createElement(Y,{className:E,key:"".concat(E,"-").concat(t),direction:f,index:t,marginDirection:k,split:m,wrap:j},e)})),C=n.useMemo((function(){return{horizontalSize:_,verticalSize:w,latestIndex:D,supportFlexGap:g}}),[_,w,D,g]);if(0===P.length)return null;var J={};return j&&(J.flexWrap="wrap",g||(J.marginBottom=-w)),g&&(J.columnGap=_,J.rowGap=w),n.createElement("div",(0,F.Z)({className:z,style:(0,F.Z)((0,F.Z)({},J),y)},b),n.createElement(ee.Provider,{value:C},R))},ne=r(71577),ae=r(74130);function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var ie=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e);return r.plot_name=t,r},le=function(e){var t=e.lastSelectedPlot,r=e.setSelectedPlots,a=e.selectedPlots,o=e.query,i=e.overlaidGlobally,l=[{title:"Run",dataIndex:"run_number"},{title:"Dataset name",dataIndex:"dataset_name"},{title:"Path",dataIndex:"folders_path"},{title:"Plot Name",dataIndex:"plot_name"},{title:"Label",render:function(e){if(e.folders_path&&e.plot_name)return(0,P.jsx)(B.Z,{id:e.folders_path+e.plot_name,defaultValue:e.label,name:e.folders_path+e.plot_name,placeholder:"label",value:e.label,onChange:function(t){var n=t.target.value,o=function(e,t,r){var n=(0,c.Z)(t),a=n.indexOf(e);return n[a].label=encodeURI(r),n}(e,a,encodeURI(n));r(o)}})}},{title:"Action",key:"action",render:function(e){var t=i.findIndex((function(t){return t.plot_name===e.plot_name&&t.folders_path===e.folders_path&&t.dataset_name===e.dataset_name&&t.run_number===e.run_number}))>-1;return(0,P.jsx)(re,{size:"small",children:(0,P.jsx)(z.Z,{title:t?"Plot was overlaid before (globally or by layout configuration) selecting the plot.":"",children:(0,P.jsx)(ne.Z,{type:"link",disabled:t,onClick:function(){r(function(e,t){var r=(0,c.Z)(t),n=r.indexOf(e);return r.splice(n,1),r}(e,a))},children:"Delete"})})})}}];return n.useEffect((function(){if(o.overlayPlots){var e=o.overlayPlots.split("&").map((function(e){var t=e.split("reflabel="),r=2===t.length?t[1]:"",n=t[0].split("/"),a=n.pop();return{folders_path:h()(n).join("/"),plot_name:a,label:r,run_number:o.run_number,dataset_name:o.dataset_name}}));r(e)}}),[]),n.useEffect((function(){if(t&&t.plot_name){var e=(0,c.Z)(a),n=(o=t,-1===(i=e).indexOf(o)&&i.push(o),i);r(n)}var o,i}),[t]),n.useEffect((function(){var e=i.filter((function(e){if(!a.includes(e))return e})).concat(a);e.length>0&&r(e)}),[o.overlaidGlobally]),a.length>0?(0,P.jsx)(ae.iy,{pagination:{defaultPageSize:1,pageSizeOptions:["1","2","3","4","5"],showSizeChanger:!0},columns:l,dataSource:a.reverse()}):(0,P.jsx)(P.Fragment,{})},se=r(94108),ce=r(18554),ue=r(10925),pe=r(80129),de=r.n(pe);function fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var me=function(){var e=(0,u.Z)(d().mark((function e(t,r){var n,a,o,l,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=he({},t),e.next=3,delete n.overlayPlots;case 3:return e.next=5,delete n.overlaidSeparately;case 5:return e.next=7,delete n.customizationParams;case 7:return a=he({},t.customise),e.next=10,delete n.overlaidGlobally;case 10:o=he(he(he({},n),a),{},{overlaidGlobally:r.query.overlaidGlobally}),l=de().stringify(o,{}),s="/"!==O.A?"".concat(O.A,"?").concat(l):void 0,i.default.push({pathname:r.pathname,query:o},s);case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),ye=function(){var e=(0,u.Z)(d().mark((function e(t,r,n){var a,o,l,s,c,u,p,f;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=he({},r),o=r.overlaidSeparately,l=o.ref,s={ref:l},e.next=6,delete a.customise;case 6:return e.next=8,delete a.overlaidSeparately;case 8:return e.next=10,delete a.customizationParams;case 10:return e.next=12,delete a.overlaidGlobally;case 12:c=he({},r.customise),u=he(he(he(he({},a),s),c),{},{overlaidGlobally:n.query.overlaidGlobally,overlayPlots:t}),p=de().stringify(u,{}),f=""!==O.A?"".concat(O.A,"?").concat(p):void 0,i.default.push({pathname:n.pathname,query:u},f);case 17:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),ve=function(){var e=(0,u.Z)(d().mark((function e(t,r,n){var a,o,l,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=he({},n),e.next=3,delete a.customizationParams;case 3:o=he(he({},r.query),{},{search:t}),l=de().stringify(o,{}),s="/"!==O.A?"".concat(O.A,"?").concat(l):void 0,i.default.push({pathname:r.pathname,query:o},s);case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),je=function(){var e=(0,u.Z)(d().mark((function e(t,r,n){var a,o,l;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=he(he({},t.query),r),o=de().stringify(a,{}),l="/"!==O.A?"".concat(O.A,"?").concat(o):void 0,i.default.push({pathname:t.pathname,query:a},l);case 4:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),be=function(e){var t=e.plotNames,r=e.setLastSelectedPlot,n=e.selectedPlots,a=e.lastSelectedPlot,o=e.dataset_name,i=e.run_number,l=t.map((function(e,t){return{key:t,plot_name:e}})),s=O.Jg.split("/"),c=s.indexOf("plotsLocalOverlay");s.splice(c,1);var u=s.join("/"),p=[{title:"Plot name",dataIndex:"plot_name",key:"plot_name",render:function(e){var t=a.folders_path,o=e,i=n.findIndex((function(e){return e.folders_path===t&&e.plot_name===o}))>-1,l=n.length>=8,s=i||l,c=l?"Cannot be selected more than 8 plots!":i?"This plot is already selected":"";return(0,P.jsx)(z.Z,{title:c,children:(0,P.jsx)(ne.Z,{disabled:s,onClick:function(){return r(ie(a,e))},children:e})})},sorter:function(e,t){return e.plot_name<t.plot_name?-1:e.plot_name>t.plot_name?1:0},sortDirections:["ascend"]},{title:"Action",dataIndex:"plot_name",key:"plot_name",render:function(e){var t={run_number:i,dataset_name:o,folders_path:a.folders_path,plot_name:encodeURIComponent(e),height:m.J7.small.size.h,width:m.J7.small.size.w},r=(0,L.Rc)(t);return(0,P.jsx)(z.Z,{title:(0,P.jsx)("img",{src:"".concat(u).concat("").concat(r)}),children:(0,P.jsx)(re,{size:"small",children:(0,P.jsx)("a",{children:"Show plot"})})})}}];return(0,P.jsx)(ae.iy,{columns:p,dataSource:l})},ge=r(4838),Oe=r(41156);function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var we=function(e){var t=e.me_count,r=e.children;return(0,P.jsx)(Oe.LH,{count:t,children:r})},Pe=function(e){var t=e.setParameters,r=e.parameters,a=e.referenceHeight,l=n.useState({dataset_name:"",run_number:"",folders_path:"",plot_name:""}),s=(0,o.Z)(l,2),u=s[0],p=s[1],d=n.useState([]),f=(0,o.Z)(d,2),m=f[0],y=f[1],j=n.useState(""),b=(0,o.Z)(j,2),g=b[0],x=b[1],_=n.useState([]),S=(0,o.Z)(_,2),Z=S[0],z=S[1],E=n.useRef(null),k=n.useRef(null),D=n.useState(0),R=(0,o.Z)(D,2),C=R[0],J=R[1],L=(0,i.useRouter)(),T=L.query,I={dataset_name:T.dataset_name,run_number:T.run_number,folders_path:u.folders_path,plot_search:T.search},N=(0,ce.Lw)(I),G=w(N,{},[O.Jg,u.folders_path,r.run_number,T.search,r.plot_search,r.dataset_name,r.plot_name]);n.useEffect((function(){var e=(0,c.Z)(m),t=m.indexOf(g);if(t>=0){var r=e.splice(0,t+1);y(r);var n=r.join("/");p({folders_path:n,plot_name:""})}else{e.push(g);var a=h()(e)?h()(e):[];y(a);var o=e.join("/");0===a.length&&p({dataset_name:"",run_number:"",folders_path:"",plot_name:""}),p({dataset_name:T.dataset_name,run_number:T.run_number,folders_path:o,plot_name:""})}}),[g]),n.useEffect((function(){var e=_e({},r),n={overlaidSeparately:{plots:Z}},a=_e(_e({},e),n);t(a),Z.map((function(e){return e.label?[e.folders_path,e.plot_name,"reflabel="+e.label].join("/"):[e.folders_path,e.plot_name].join("/")})).join("&").length>0?(e.overlaidSeparately=_e(_e({},r.overlaidSeparately),{},{plots:Z}),t(e)):(e.overlaidSeparately=_e(_e({},r.overlaidSeparately),{},{plots:[]}),t(e))}),[Z.length]);var H=r.overlaidSeparately.plots.map((function(e){return e.label})).join(",");n.useEffect((function(){var e=Z.map((function(e){return e.label?[e.folders_path,e.plot_name,"reflabel="+e.label].join("/"):[e.folders_path,e.plot_name].join("/")})).join("&");e.length>0?ye(e,r,L):me(r,L)}),[r.size,H,r.overlaidSeparately.plots,r.overlaidSeparately&&r.overlaidSeparately.ref,r.jsroot,r.stats,r.normalize,r.error]),n.useEffect((function(){k.current&&E.current?J(k.current.clientHeight+E.current.clientHeight):J(0)}),[E.current&&E.current.clientHeight,k.current&&k.current.clientHeight,k.current,a]);var q=G.data,B=function(e){var t=[],r=[];return e.forEach((function(e){t.push({subdir:e.subdir,me_count:e.me_count}),r.push(e.name)})),{directories:h()(t).sort((function(e,t){return e.subdir<t.subdir?-1:e.subdir>t.subdir?1:0})),plots:h()(r)}}(q?q.data:[]),F=B.directories,M=B.plots;return(0,P.jsxs)(ae.N0,{gutter:16,smaller:a.toString(),children:[(0,P.jsx)(A.Z,{style:{padding:8},ref:k,children:(0,P.jsx)(se.b,{folder_path:u.folders_path,changeFolderPathByBreadcrumb:function(e){return(t=e,function(e,r){var n=t.folder_path.split("/"),a=h()(n)?h()(n):[];e(a),a.length>0?r(a[a.length-1]):r("")})(y,x);var t}})}),(0,P.jsx)(ae.WC,{ref:E,children:(0,P.jsx)(le,{query:T,lastSelectedPlot:u,overlaidGlobally:r.overlaidGlobally,selectedPlots:Z,setSelectedPlots:z})}),(0,P.jsxs)(ae.Eo,{smaller:C.toString(),children:[!G.isLoading&&(0,P.jsx)(ae.WC,{children:F.sort().map((function(e){return(0,P.jsx)(A.Z,{span:4,children:(0,P.jsx)(v.dg,{children:(0,P.jsxs)(Oe.Jf,{hover:"true",display:"flex",space:"1",alignitems:"center",onClick:function(){return x(e.subdir)},children:[(0,P.jsx)(we,{me_count:e.me_count?e.me_count:0,children:(0,P.jsx)(v.JO,{})}),(0,P.jsx)(v.nB,{children:e.subdir})]})})},e.subdir)}))}),G.isLoading&&(0,P.jsx)(ae.x9,{children:(0,P.jsx)(ue.$j,{})}),!G.isLoading&&M.length>0&&(0,P.jsx)(be,{plotNames:M,setLastSelectedPlot:p,lastSelectedPlot:u,selectedPlots:Z,dataset_name:T.dataset_name,run_number:T.run_number}),0===F.length&&0===M.length&&(0,P.jsx)(ae.y4,{children:(0,P.jsx)(ge.Q,{})})]})]})},Se=r(48086),Ze=r(12028);function ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Ee=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);return r.jsroot=e,r},ke=function(e){var t=e.setReference,r=e.reference,n=e.disabled;return(0,P.jsx)(Ze.Z,{disabled:n,style:{width:"fit-content"},checkedChildren:"JSROOT enabled",unCheckedChildren:"JSROOT disabled",checked:r.jsroot,onChange:function(e){t(Ee(e,r))}})},De=r(40120),Re=r(7653);function Ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Je=De.Z.Option,Le=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);return r.ref=e,r},Te=function(e){var t=e.setReference,r=e.reference;return(0,P.jsx)(Re.Qr,{onChange:function(e){return t(Le(e,r))},defaultValue:r.ref,children:m.jJ.map((function(e){return(0,P.jsx)(Je,{value:e.value,children:e.label},e.value)}))})};function Ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Ne=De.Z.Option,Ge=function(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);return r.size=e,r},He=function(e){var t=e.setReference,r=e.reference,n=Object.keys(m.J7);return(0,P.jsx)(Re.Qr,{onChange:function(e){return t(Ge(e,r))},defaultValue:r.size,children:n.map((function(e){return(0,P.jsx)(Ne,{value:e,children:m.J7[e].label},e)}))})},qe=r(90172),Ae=r(49549);function Be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Me=function(e){var t,r=e.router,a=e.parameters,i=e.setParameters,l=r.query,s=a.size,c=l.overlayPosition?l.overlayPosition:"overlay",p=!!l.jsroot&&"true"===l.jsroot,f=n.useState(!1),y=(0,o.Z)(f,2),v=y[0],b=y[1],g=n.useState({}),O=(0,o.Z)(g,2),x=O[0],_=O[1],w=Object.keys(a.customise?a.customise:{}).length>0,S=[{label:"Normalize",value:!l.normalize||"true"===l.normalize},{label:"Stats",value:!l.stats||"true"===l.stats},{label:"Error",value:!!l.error&&"true"===l.error}],Z=n.useState((t={size:s,jsroot:p,ref:c},(0,j.Z)(t,S[0].label.toLocaleLowerCase(),S[0].value),(0,j.Z)(t,S[1].label.toLocaleLowerCase(),S[1].value),(0,j.Z)(t,S[2].label.toLocaleLowerCase(),S[2].value),t)),E=(0,o.Z)(Z,2),k=E[0],D=E[1];return n.useEffect((function(){var e=Fe({},a);e.height=m.J7[k.size].size.h,e.width=m.J7[k.size].size.w,e.size=k.size,e.overlaidSeparately&&(e.overlaidSeparately.ref=k.ref),e.jsroot=k.jsroot,e.size=k.size,e.stats=k.stats,e.normalize=k.normalize,e.error=k.error,e.customise=x;var t=Fe(Fe({},e),{},{overlaidSeparately:Fe({},e.overlaidSeparately)});i(t)}),[k.size,k.jsroot,k.ref,k[S[0].label.toLocaleLowerCase()],k[S[1].label.toLocaleLowerCase()],k[S[2].label.toLocaleLowerCase()],x,l.ref,l.normalize,l.stats,l.error,l.jsroot,l.size]),n.useEffect((function(){var e={xtype:l.xtype,xmin:l.xmin,xmax:l.xmax,ytype:l.ytype,ymin:l.ymin,ymax:l.ymax,ztype:l.ztype,zmin:l.zmin,zmax:l.zmax,drawopts:l.drawopts,withref:l.withref};_(h()(e))}),[]),n.useEffect((function(){w&&Se.ZP.info("Plot is already customised")}),[w]),(0,P.jsxs)(ae.im,{direction:"column",children:[(0,P.jsx)(Ae.F,{plot_name:a.plot_name,open:v,customizationParams:x,onCancel:function(){return b(!1)},setCustomisationParams:function(){var e=(0,u.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(t),e.next=3,je(r,t,a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),(0,P.jsxs)(ae.im,{direction:"row",children:[(0,P.jsx)(ae.rj,{space:"2",children:(0,P.jsx)(He,{setReference:D,reference:k})}),(0,P.jsx)(ae.rj,{space:"2",children:(0,P.jsx)(Te,{setReference:D,reference:k})}),(0,P.jsx)(ae.rj,{space:"2",children:(0,P.jsx)(ke,{disabled:!!l.overlayPlots,setReference:D,reference:k})}),(0,P.jsx)(ae.rj,{space:"2",children:(0,P.jsx)(z.Z,{title:w?"This plot is customised!":"",children:(0,P.jsx)(ae.Sn,{isPlotCustomized:w.toString(),onClick:function(){return b(!v)},children:"Customize"})})})]}),(0,P.jsx)(ae.im,{direction:"row",children:S.map((function(e){return(0,P.jsx)(ae.rj,{space:"2",children:(0,P.jsx)(qe.J,{option:e,setReference:D,reference:k})},e.label)}))})]})},We=r(13722),Ve=r(97183),Xe=r(50963);function Qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Ue=function(e){var t=e.parameters,r=e.setParameters,a=(0,i.useRouter)(),l=a.query,s=n.useState(l.plot_search),c=(0,o.Z)(s,2),u=c[0],p=c[1];return n.useEffect((function(){ve(u||void 0,a,t)}),[u]),n.useEffect((function(){var e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(r),!0).forEach((function(t){(0,j.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t);e.search=l.search,r(e)}),[l.search]),n.useMemo((function(){return(0,P.jsx)(Xe.ZP,{onChange:function(e){return p(e.target.value)},children:(0,P.jsx)(Oe.jp,{children:(0,P.jsx)(Oe.tg,{defaultValue:l.search,id:"plot_search",placeholder:"Enter plot name"})})})}),[u])},Ye=function(){var e=(0,i.useRouter)(),t=e.query,r=t.run_number,a=t.dataset_name,s=t.folders_path,c=t.plot_name,u=(t.size,n.useRef(null)),p=n.useRef(null),d=n.useState(),f=(0,o.Z)(d,2),h=f[0],y=f[1],v=n.useState(0),j=(0,o.Z)(v,2),b=j[0],g=j[1],O=n.useState(0),x=(0,o.Z)(O,2),_=x[0],w=x[1];return n.useEffect((function(){u.current&&g(u.current.clientHeight)}),[u.current]),n.useEffect((function(){p.current&&w(p.current.clientWidth)}),[p.current]),n.useEffect((function(){if(Object.keys(t).length>0){var e=t.overlaidGlobally?t.overlaidGlobally.split("&"):[],n=e.map((function(t){if(e){var r=t.split("/"),n=r.pop(),a=r.pop(),o=r.shift(),i=r.splice(3).join("/");return{run_number:o,dataset_name:"/"+r.join("/"),folders_path:i,plot_name:a,label:n}}})),o=t.ref?t.ref:"overlay",i={run_number:r,dataset_name:a,folders_path:s,plot_name:c,size:t.size?t.size:"large",jsroot:!!t.jsroot&&"true"===t.jsroot,stats:!!t.stats&&"true"===t.stats,normalize:!t.normalize||"true"===t.normalize,overlaidSeparately:{plots:[],ref:o},overlaidGlobally:n,height:m.J7[t.size?t.size:"large"].size.h,width:m.J7[t.size?t.size:"large"].size.w};y(i)}}),[t.plot_name]),h?(0,P.jsxs)(Ve.Z,{children:[(0,P.jsx)(We.eb,{justifyContent:"space-between",children:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(We.JI,{children:(0,P.jsx)(We.IY,{children:(0,P.jsx)(We.ps,{src:"../images/CMSlogo_white_red_nolabel_1024_May2014.png"})})}),(0,P.jsxs)(ae.oS,{children:[(0,P.jsx)(ae.nf,{children:(0,P.jsxs)(l.Z,{color:"geekblue",children:["Run :",h.run_number]})}),(0,P.jsx)(ae.nf,{children:(0,P.jsxs)(l.Z,{color:"geekblue",children:["Dataset: ",h.dataset_name]})}),(0,P.jsx)(ae.nf,{children:(0,P.jsxs)(l.Z,{color:"geekblue",children:[" Folders path: ",h.folders_path]})}),(0,P.jsx)(ae.nf,{children:(0,P.jsxs)(l.Z,{color:"geekblue",children:["Plot name:  ",h.plot_name]})}),(0,P.jsx)(Ue,{parameters:h,setParameters:y})]})]})}),(0,P.jsx)(ae.LT,{children:(0,P.jsxs)(ae.im,{direction:"row",children:[(0,P.jsx)(ae.MF,{ref:p,proportion:"50%",border:(!0).toString(),children:(0,P.jsx)(q,{plotsAreaWidth:_,parameters:h})}),(0,P.jsxs)(ae.MF,{proportion:"50%",children:[(0,P.jsx)("div",{ref:u,children:(0,P.jsx)(Me,{parameters:h,router:e,setParameters:y})}),(0,P.jsx)(Pe,{referenceHeight:b,parameters:h,setParameters:y})]})]})})]}):(0,P.jsx)(P.Fragment,{})},$e=function(){return(0,P.jsxs)("div",{children:[(0,P.jsx)(a.default,{children:(0,P.jsx)("script",{crossOrigin:"anonymous",type:"text/javascript",src:"./jsroot-5.8.0/scripts/JSRootCore.js?2d&hist&more2d"})}),(0,P.jsx)(Ye,{})]})}},94932:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/plotsLocalOverlay",function(){return r(37132)}])}},function(e){e.O(0,[662,182,626,774,888,179],(function(){return t=94932,e(e.s=t);var t}));var t=e.O();_N_E=t}]);